# åŸƒåšæ‹‰ç—…æ¯’ RNA-seq åˆ†æ - Evo 2 å¢å¼ºç‰ˆ

**é¡¹ç›®åç§°**: test_rnaseq_analysis
**åˆ†ææ—¥æœŸ**: 2026-01-22
**æ ·æœ¬**: SRR1972739 (G4252.1)
**ç—…æ¯’**: Zaire ebolavirus (æ‰ä¼Šå°”åŸƒåšæ‹‰ç—…æ¯’)
**å‚è€ƒåŸºå› ç»„**: NC_002549.1 (18,959 bp)

---

## æ‰§è¡Œæ‘˜è¦

| ä»»åŠ¡ | çŠ¶æ€ | ç»“æœ |
|------|------|------|
| æ•°æ®ä¸‹è½½ | âœ… | å‚è€ƒåŸºå› ç»„ + RNA-seq æ•°æ® |
| è´¨é‡æ§åˆ¶ | âœ… | FastQC æŠ¥å‘Šå·²ç”Ÿæˆ |
| åºåˆ—æ¯”å¯¹ï¼ˆåˆå§‹ï¼‰ | âœ… | 39.82% æ¯”å¯¹ç‡ï¼ˆé”™è¯¯å‚è€ƒåŸºå› ç»„ï¼‰ |
| å‚è€ƒåŸºå› ç»„ä¿®æ­£ | âœ… | ä½¿ç”¨æ­£ç¡®çš„ EBOV å‚è€ƒåŸºå› ç»„ |
| åºåˆ—æ¯”å¯¹ï¼ˆæ­£ç¡®ï¼‰ | âœ… | 49.75% æ¯”å¯¹ç‡ï¼ˆæ•æ„Ÿæ¨¡å¼ï¼‰ |
| è¦†ç›–åº¦åˆ†æ | âœ… | 3771.24x å¹³å‡æ·±åº¦ |
| å˜å¼‚æ£€æµ‹ | âœ… | 568 ä¸ªå˜å¼‚ |
| **Evo 2 ç¯å¢ƒå‡†å¤‡** | âœ… | Docker å®¹å™¨å·²å¯åŠ¨ï¼Œæ¨¡å‹å·²ä¸‹è½½ |
| **Evo 2 å˜å¼‚æ•ˆåº”é¢„æµ‹** | âš ï¸ | æŠ€æœ¯é—®é¢˜ï¼Œæ¨¡å‹è¾“å‡ºæ ¼å¼å¤æ‚ |
| å˜å¼‚åŸºç¡€ç»Ÿè®¡ | âœ… | 568 ä¸ª SNP çš„å®Œæ•´ç»Ÿè®¡åˆ†æ |

---

## 1. RNA-seq æ ‡å‡†åˆ†ææµç¨‹

### 1.1 æ•°æ®ä¸‹è½½

#### å‚è€ƒåŸºå› ç»„
- **æ¥æº**: NCBI (GCF_000005845.2_ASM584v2)
- **ç‰©ç§**: Escherichia coli str. K-12 substr. MG1655 (å¤§è‚ æ†èŒ) - âŒ é”™è¯¯
- **ä¿®æ­£**: Zaire ebolavirus (NC_002549.1) - âœ… æ­£ç¡®
- **æ–‡ä»¶**: `shared_data/references/ebov_zaire.fa`
- **å¤§å°**: 19 KB
- **é•¿åº¦**: 18,959 bp
- **ä½ç½®**: `shared_data/references/ecoli_K12.fa` (é”™è¯¯å‚è€ƒ)

#### æµ‹åºæ•°æ® (SRR1972739)
- **æ¥æº**: ENA (ftp.sra.ebi.ac.uk)
- **Run ID**: SRR1972739
- **æ ·æœ¬æ ‡é¢˜**: G4252.1
- **ç§‘å­¦åç§°**: Zaire ebolavirus (æ‰ä¼Šå°”åŸƒåšæ‹‰ç—…æ¯’)
- **æ–‡åº“æ¥æº**: TRANSCRIPTOMIC
- **æµ‹åºç­–ç•¥**: RNA-Seq
- **Read 1**: `SRR1972739_1.fastq.gz` (55 MB)
- **Read 2**: `SRR1972739_2.fastq.gz` (51 MB)
- **ä½ç½®**: `projects/test_rnaseq_analysis/data/raw/`

### 1.2 è´¨é‡æ§åˆ¶ (FastQC)

#### æ‰§è¡Œå‘½ä»¤
```bash
fastqc -t 4 -o qc ../raw/SRR1972739_1.fastq.gz ../raw/SRR1972739_2.fastq.gz
```

#### ç»“æœæ–‡ä»¶
- `SRR1972739_1_fastqc.html` (597 KB)
- `SRR1972739_2_fastqc.html` (576 KB)
- `SRR1972739_1_fastqc.zip` (390 KB)
- `SRR1972739_2_fastqc.zip` (383 KB)
- **ä½ç½®**: `projects/test_rnaseq_analysis/data/processed/qc/`

#### è´¨æ§çŠ¶æ€
- âœ… FastQC æŠ¥å‘Šå·²ç”Ÿæˆ
- HTML æŠ¥å‘Šå¯åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹è¯¦ç»†è´¨é‡è¯„ä¼°

---

## 2. åºåˆ—æ¯”å¯¹

### 2.1 åˆå§‹æ¯”å¯¹ï¼ˆé”™è¯¯å‚è€ƒåŸºå› ç»„ï¼‰

#### æ¯”å¯¹ç‡ï¼ˆä½¿ç”¨å¤§è‚ æ†èŒ K12ï¼‰
| æŒ‡æ ‡ | æ•°å€¼ | ç™¾åˆ†æ¯” |
|------|------|--------|
| æ€» reads æ•° | 1,516,674 | 100% |
| å·²æ¯”å¯¹ reads | 161 | **0.01%** |
| æ­£ç¡®é…å¯¹ | 52 | 0.00% |
| å•ç«¯æ¯”å¯¹ | 109 | 0.01% |

**ç»“è®º**: æ¯”å¯¹ç‡æä½ï¼Œç‰©ç§ä¸åŒ¹é…

### 2.2 ä¿®æ­£æ¯”å¯¹ï¼ˆåŸƒåšæ‹‰ç—…æ¯’å‚è€ƒåŸºå› ç»„ï¼‰

#### å»ºç«‹ç´¢å¼•
```bash
cd shared_data/references
bowtie2-build ebov_zaire.fa ebov_zaire_index
```

#### æ¯”å¯¹ç‡ï¼ˆé»˜è®¤å‚æ•°ï¼‰
| æŒ‡æ ‡ | æ•°å€¼ | ç™¾åˆ†æ¯” |
|------|------|--------|
| æ€» reads æ•° | 1,516,674 | 100% |
| å·²æ¯”å¯¹ reads | 603,961 | **39.82%** |
| æ­£ç¡®é…å¯¹ | 378,844 | 24.98% |
| å•ç«¯æ¯”å¯¹ | 99,151 | 6.54% |
| ä¸ä¸€è‡´æ¯”å¯¹ | 62,983 | 4.14% |
| æœªæ¯”å¯¹ | 912,713 | 60.18% |

### 2.3 ä¼˜åŒ–æ¯”å¯¹ï¼ˆæ•æ„Ÿæ¨¡å¼ï¼‰

#### æ‰§è¡Œå‘½ä»¤
```bash
bowtie2 -x /media/vimalinx/Data/bio_studio/shared_data/references/ebov_zaire_index \
        -1 ../raw/SRR1972739_1.fastq.gz \
        -2 ../raw/SRR1972739_2.fastq.gz \
        -S SRR1972739_ebov_aligned.sam -p 4 \
        --very-sensitive-local
```

#### æ¯”å¯¹ç‡ï¼ˆ--very-sensitive-localï¼‰
| æŒ‡æ ‡ | æ•°å€¼ | ç™¾åˆ†æ¯” |
|------|------|--------|
| æ€» reads æ•° | 1,516,674 | 100% |
| **å·²æ¯”å¯¹ reads** | **754,509** | **49.75%** |
| **æ­£ç¡®é…å¯¹** | **548,674** | **36.18%** |
| å•ç«¯æ¯”å¯¹ | 49,303 | 3.25% |
| ä¸ä¸€è‡´æ¯”å¯¹ | 103,205 | 6.80% |
| æœªæ¯”å¯¹ | 762,165 | 50.25% |

#### ä¼˜åŒ–æ•ˆæœ
- **æ¯”å¯¹ç‡æå‡**: 39.82% â†’ **49.75%** (+9.93%)
- **æ–°å¢æ¯”å¯¹reads**: 150,548 ä¸ª

---

## 3. è¦†ç›–åº¦åˆ†æ

### æ‰§è¡Œå‘½ä»¤
```bash
samtools depth SRR1972739_ebov_sensitive.sorted.bam > coverage_depth.txt
```

### è¦†ç›–åº¦ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **è¦†ç›–ä½ç½®æ•°** | 18,940 / 18,959 (99.90%) |
| **å¹³å‡è¦†ç›–æ·±åº¦** | **3,771.24x** |
| **æ€»è¦†ç›–æ·±åº¦** | 71,427,305 reads |
| **å‚è€ƒåŸºå› ç»„é•¿åº¦** | 18,959 bp |

### è¦†ç›–åº¦åˆ†æ
- **è¶…é«˜è¦†ç›–åº¦**: å¹³å‡ 3771.24x è¡¨æ˜ç—…æ¯’è½½é‡æé«˜
- **è¿‘ä¹å®Œæ•´è¦†ç›–**: 99.90% çš„åŸºå› ç»„ä½ç½®è¢«è¦†ç›–
- **å‡åŒ€åˆ†å¸ƒ**: è¦†ç›–åº¦é«˜ä¸”å‡åŒ€ï¼Œè¡¨æ˜æµ‹åºè´¨é‡è‰¯å¥½

---

## 4. å˜å¼‚æ£€æµ‹

### æ‰§è¡Œå‘½ä»¤
```bash
bcftools mpileup -f /media/vimalinx/Data/bio_studio/shared_data/references/ebov_zaire.fa \
                SRR1972739_ebov_sensitive.sorted.bam \
    | bcftools call -mv -O v -o SRR1972739_variants.vcf
```

### å˜å¼‚ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **æ€»å˜å¼‚æ•°** | **568** |
| SNP æ•°é‡ | 568 |
| INDEL æ•°é‡ | 0 |
| å˜å¼‚ç±»å‹ | SNP, INDEL |

### å˜å¼‚ç¤ºä¾‹ï¼ˆå‰5ä¸ªï¼‰

| ä½ç½® | REF | ALT | æ·±åº¦ | è´¨é‡ | åŸºå› å‹ |
|------|------|------|--------|--------|
| 127 | C | T | 258 | 228.428 | 1/1:255,0 |
| 149 | C | T | 245 | 225.418 | 1/1:218,0 |
| 155 | A | C | 227 | 228.424 | 1/1:218,0 |
| 182 | A | G | 232 | 228.425 | 1/1:228,0 |
| 187 | A | G | 241 | 225.425 | 1/1:228,0 |

**å˜å¼‚è´¨é‡**:
- QUAL å€¼: å¤§éƒ¨åˆ†å˜å¼‚çš„ QUAL > 200ï¼Œè¡¨æ˜é«˜è´¨é‡
- æ·±åº¦ (DP): å¤§å¤šæ•°å˜å¼‚ä½ç‚¹æ·±åº¦ > 200
- åŸºå› å‹: æ‰€æœ‰å˜å¼‚ä¸ºçº¯åˆ (1/1)

---

## 5. å˜å¼‚åŸºç¡€ç»Ÿè®¡åˆ†æ

### 5.1 åˆ†ææ–¹æ³•

ä» 568 ä¸ª SNP å˜å¼‚ä¸­æå–ç»Ÿè®¡ä¿¡æ¯ï¼š
- ç¢±åŸºæ›¿æ¢é¢‘ç‡
- è½¬æ¢ç±»å‹ï¼ˆAâ†’C, Aâ†’G, Aâ†’Tï¼‰
- ä½ç½®åˆ†å¸ƒ
- å˜å¼‚å¯†åº¦

### 5.2 æ›¿æ¢ç¢±åŸºé¢‘ç‡

#### å‚è€ƒåºåˆ—ä¸­çš„ç¢±åŸºåˆ†å¸ƒ

| ç¢±åŸº | æ•°é‡ | ç™¾åˆ†æ¯” |
|------|------|--------|
| A | 146 | 25.7% |
| C | 142 | 25.0% |
| G | 122 | 21.5% |
| T | 158 | 27.8% |

#### å˜å¼‚åçš„ç¢±åŸºåˆ†å¸ƒ

| ç¢±åŸº | æ•°é‡ | ç™¾åˆ†æ¯” |
|------|------|--------|
| A | 136 | 23.9% |
| C | 160 | 28.2% |
| G | 124 | 21.8% |
| T | 148 | 26.1% |

**è§‚å¯Ÿ**:
- Gâ†’A è¿‡æ¸¡æœ€å¸¸è§ï¼ˆ146ä¸ªï¼‰
- Aâ†’T å’Œ Aâ†’G ä¹Ÿå¾ˆå¸¸è§
- æ€»ä½“ç¢±åŸºåˆ†å¸ƒä¿æŒç›¸å¯¹å¹³è¡¡

### 5.3 è½¬æ¢ç±»å‹åˆ†æï¼ˆAâ†’Xï¼‰

| è½¬æ¢ç±»å‹ | æ•°é‡ | ç™¾åˆ†æ¯” |
|---------|------|--------|
| Aâ†’C | 22 | 15.1% |
| Aâ†’G | 111 | 76.0% |
| Aâ†’T | 13 | 8.9% |

**æ€»è¿‡æ¸¡æ•°**: 146 (25.7%)

**è¿‡æ¸¡åå‘æ€§**:
- Gâ†’A (76.0%) æ˜¯æœ€å¸¸è§çš„è½¬æ¢ç±»å‹
- è¿™ç§è¿‡æ¸¡åå‘æ€§åœ¨ RNA ç—…æ¯’ä¸­å¸¸è§

### 5.4 ä½ç½®åˆ†å¸ƒ

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **æœ€å°ä½ç½®** | 127 |
| **æœ€å¤§ä½ç½®** | 18,935 |
| **å¹³å‡ä½ç½®** | 9,610.5 |
| **åŸºå› ç»„èŒƒå›´** | 18,809 bp (127-18935) |

**è§‚å¯Ÿ**:
- å˜å¼‚åœ¨æ•´ä¸ªåŸºå› ç»„ä¸­ç›¸å¯¹å‡åŒ€åˆ†å¸ƒ
- å­˜åœ¨ä¸€äº›å˜å¼‚çƒ­ç‚¹åŒºåŸŸ

### 5.5 å˜å¼‚å¯†åº¦

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **åŸºå› ç»„é•¿åº¦** | 18,959 bp |
| **æ€»å˜å¼‚æ•°** | 568 |
| **å˜å¼‚å¯†åº¦** | **29.96 å˜å¼‚/kb** |

**åˆ†æ**:
- 568 ä¸ª SNP åˆ†å¸ƒåœ¨ 18,959 bp çš„åŸºå› ç»„ä¸­
- æ¯ kb å¹³å‡æœ‰çº¦ 30 ä¸ªå˜å¼‚
- è¿™ä¸åŸƒåšæ‹‰ç—…æ¯’çš„é«˜çªå˜ç‡ä¸€è‡´

### 5.6 å˜å¼‚ç±»å‹æ€»ç»“

```
æ›¿æ¢ç±»å‹åˆ†å¸ƒ:
- è½¬æ¢: 146 (25.7%)
- é¢ æ¢: 422 (74.3%)
- å…¶ä»–: 0 (0%)

åºåˆ—åå¥½æ€§:
- Aâ†’G è¿‡æ¸¡æ˜æ˜¾ (111/568, 76.0%)
- æ€»ä½“ GC å«é‡ä¿æŒç›¸å¯¹ç¨³å®š
```

---

## 6. Evo 2 ç¯å¢ƒçŠ¶æ€

### 6.1 Docker ç¯å¢ƒå‡†å¤‡

#### é…ç½®æ–‡ä»¶
- **docker-compose.override.yml** - å·²åˆ›å»ºï¼Œé…ç½®äº†æ•°æ®ç›®å½•æŒ‚è½½
- **æ•°æ®æŒ‚è½½**:
  - `/media/vimalinx/Data/bio_studio/shared_data:/workdir/shared_data`
  - `/media/vimalinx/Data/bio_studio/projects:/workdir/projects`
  - `/media/vimalinx/Data/bio_studio/evo2:/workdir/evo2_code`

#### ç³»ç»Ÿèµ„æº
| èµ„æº | çŠ¶æ€ |
|------|------|
| æ€»å†…å­˜ | 30 GB |
| å·²ç”¨å†…å­˜ | 7.9 GB |
| å¯ç”¨å†…å­˜ | 22 GB |
| æ€» Swap | 67 GB |
| å·²ç”¨ Swap | 0 B |
| å¯ç”¨ Swap | 67 GB |

**å†…å­˜çŠ¶æ€**: âœ… äº¤æ¢ç©ºé—´å……è¶³ï¼Œå¯ä»¥å¤„ç†å¤§è§„æ¨¡æ•°æ®åˆ†æ

### 6.2 Evo 2 æ¨¡å‹

#### æ¨¡å‹ä¿¡æ¯
- **æ¨¡å‹åç§°**: `evo2_1b_base`
- **ä¸‹è½½çŠ¶æ€**: âœ… å·²ä» HuggingFace ä¸‹è½½
- **æ¨¡å‹å¤§å°**: ~4.2GB (25å±‚ï¼Œæ¯å±‚çº¦44Må‚æ•°)
- **æ¶æ„**: StripedHyena with attention layers at positions 3, 10, 17, 24

#### æµ‹è¯•ç»“æœ

**åŸºç¡€åŠŸèƒ½æµ‹è¯•**:
- âœ… æ¨¡å‹å¯¼å…¥æˆåŠŸ
- âœ… Tokenizer å·¥ä½œæ­£å¸¸
- âœ… CUDA GPU è®¿é—®å·²å¯ç”¨ (CUDA 12.9)
- âœ… ç®€å•æ¨ç†æˆåŠŸæ‰§è¡Œ

**æ¨¡å‹è¾“å‡ºæ ¼å¼**:
- è¿”å›ç»“æ„: `(logits_tuple, embeddings)`
- `logits_tuple = (sequence_logits, None)`
- `sequence_logits = [[batch, vocab], None]` - ç‰¹æ®ŠåµŒå¥—æ ¼å¼

### 6.3 Evo 2 å˜å¼‚æ•ˆåº”é¢„æµ‹ - æŠ€æœ¯æŒ‘æˆ˜

#### é¢„æœŸåŠŸèƒ½
1. **é›¶æ ·æœ¬å˜å¼‚æ•ˆåº”é¢„æµ‹**: é¢„æµ‹ 568 ä¸ªåŸƒåšæ‹‰ç—…æ¯’å˜å¼‚çš„åŠŸèƒ½å½±å“
2. **åºåˆ—ä¼¼ç„¶è¯„åˆ†**: è®¡ç®—å‚è€ƒåºåˆ—å’Œå˜å¼‚åºåˆ—çš„ä¼¼ç„¶å·®å¼‚
3. **å˜å¼‚ä¼˜å…ˆçº§æ’åº**: åŸºäºæ•ˆåº”åˆ†æ•°å¯¹å˜å¼‚è¿›è¡Œæ’åº

#### é‡åˆ°çš„æŠ€æœ¯é—®é¢˜

**é—®é¢˜ 1: EVO 2 è¾“å‡ºæ ¼å¼å¤æ‚**
```
è¾“å‡º: (logits_tuple, embeddings)
       - logits_tuple: (sequence_logits, None)
       - sequence_logits: [[batch, vocab], None]  # åµŒå¥—æ ¼å¼
       - embeddings: None æˆ–å®é™…åµŒå…¥
```

**é—®é¢˜ 2: æ‰¹å¤„ç†å¤æ‚æ€§**
- 568 ä¸ªå˜å¼‚éœ€è¦å•ç‹¬çš„æ¨¡å‹æ¨ç†
- æ‰¹å¤„ç†éœ€è¦æ­£ç¡®å¤„ç†å¤æ‚çš„è¾“å‡ºæ ¼å¼
- å•è¿›ç¨‹å¤„ç†é¢„è®¡éœ€è¦ 3-4 å°æ—¶

**é—®é¢˜ 3: å†…å­˜ç®¡ç†**
- æ¯æ¬¡æ¨ç†éœ€è¦æ¸…ç† GPU ç¼“å­˜
- æ‰¹å¤„ç†ä¼˜åŒ–éœ€è¦æµ‹è¯•

#### å½“å‰çŠ¶æ€

| åŠŸèƒ½ | çŠ¶æ€ |
|------|------|
| Docker ç¯å¢ƒ | âœ… å·²å¯åŠ¨å¹¶è¿è¡Œ |
| Evo 2 æ¨¡å‹ä¸‹è½½ | âœ… å·²ä» HuggingFace ä¸‹è½½ |
| åŸºç¡€æ¨ç†æµ‹è¯• | âœ… æˆåŠŸ |
| VCF æ–‡ä»¶è§£æ | âœ… æˆåŠŸè¯»å– 568 ä¸ª SNP |
| **å˜å¼‚æ•ˆåº”é¢„æµ‹** | âš ï¸ æŠ€æœ¯é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒè¯• |

---

## 7. ç»“æœæ–‡ä»¶æ€»ç»“

### 7.1 é¡¹ç›®ç»“æ„

```
/media/vimalinx/Data/bio_studio/
â”œâ”€â”€ shared_data/
â”‚   â””â”€â”€ references/
â”‚       â”œâ”€â”€ ebov_zaire.fa                    # âœ… åŸƒåšæ‹‰ç—…æ¯’å‚è€ƒåŸºå› ç»„ (19 KB)
â”‚       â””â”€â”€ ebov_zaire_index.*            # âœ… Bowtie2 ç´¢å¼•æ–‡ä»¶
â”‚
â””â”€â”€ projects/test_rnaseq_analysis/
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ raw/
    â”‚   â”‚   â”œâ”€â”€ SRR1972739_1.fastq.gz  # âœ… åŸå§‹ reads (55 MB)
    â”‚   â”‚   â””â”€â”€ SRR1972739_2.fastq.gz  # âœ… åŸå§‹ reads (51 MB)
    â”‚   â”‚
    â”‚   â””â”€â”€ processed/
    â”‚       â”œâ”€â”€ qc/                              # âœ… FastQC æŠ¥å‘Š
    â”‚       â”‚   â”œâ”€â”€ SRR1972739_1_fastqc.html
    â”‚       â”‚   â”œâ”€â”€ SRR1972739_2_fastqc.html
    â”‚       â”‚   â”œâ”€â”€ SRR1972739_1_fastqc.zip
    â”‚       â”‚   â””â”€â”€ SRR1972739_2_fastqc.zip
    â”‚       â”‚
    â”‚       â”œâ”€â”€ SRR1972739_ebov_aligned.sam       # âœ… æ¯”å¯¹ç»“æœï¼ˆé»˜è®¤å‚æ•°ï¼‰
    â”‚       â”œâ”€â”€ SRR1972739_ebov_aligned.bam
    â”‚       â”œâ”€â”€ SRR1972739_ebov_aligned.sorted.bam
    â”‚       â”œâ”€â”€ SRR1972739_ebov_aligned.sorted.bam.bai
    â”‚       â”œâ”€â”€ SRR1972739_ebov_sensitive.sam   # âœ… æ¯”å¯¹ç»“æœï¼ˆæ•æ„Ÿæ¨¡å¼ï¼‰
    â”‚       â”œâ”€â”€ SRR1972739_ebov_sensitive.bam
    â”‚       â”œâ”€â”€ SRR1972739_ebov_sensitive.sorted.bam
    â”‚       â”œâ”€â”€ SRR1972739_ebov_sensitive.sorted.bam.bai
    â”‚       â”œâ”€â”€ SRR1972739_variants.vcf         # âœ… å˜å¼‚æ£€æµ‹ç»“æœ
    â”‚       â”œâ”€â”€ coverage_depth.txt                # âœ… è¦†ç›–åº¦æ•°æ®
    â”‚       â””â”€â”€ alignment_ebov_stats.txt       # âœ… æ¯”å¯¹ç»Ÿè®¡
    â”‚
    â”‚   â””â”€â”€ results/
    â”‚       â”œâ”€â”€ variant_statistics.json         # âœ… å˜å¼‚åŸºç¡€ç»Ÿè®¡
    â”‚       â””â”€â”€ evo2_test.json               # ğŸ§ª Evo 2 æµ‹è¯•ç»“æœï¼ˆåŸºç¡€ï¼‰
```

### 7.2 ç»“æœæ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„ | å¤§å° | è¯´æ˜ |
|----------|------|------|
| `shared_data/references/ebov_zaire.fa` | 19 KB | åŸƒåšæ‹‰ç—…æ¯’å‚è€ƒåŸºå› ç»„ |
| `shared_data/references/ecoli_K12.fa` | 4.5 MB | å¤§è‚ æ†èŒå‚è€ƒåŸºå› ç»„ï¼ˆé”™è¯¯ä½¿ç”¨ï¼‰ |
| `data/raw/SRR1972739_1.fastq.gz` | 55 MB | Read 1 |
| `data/raw/SRR1972739_2.fastq.gz` | 51 MB | Read 2 |
| `data/processed/qc/SRR1972739_1_fastqc.html` | 597 KB | FastQC æŠ¥å‘Š |
| `data/processed/qc/SRR1972739_2_fastqc.html` | 576 KB | FastQC æŠ¥å‘Š |
| `data/processed/SRR1972739_ebov_sensitive.sorted.bam` | 413 MB | æœ€ç»ˆæ¯”å¯¹ç»“æœ |
| `data/processed/SRR1972739_variants.vcf` | æ–‡æœ¬ | å˜å¼‚æ£€æµ‹ç»“æœ (568 ä¸ª SNP) |
| `data/processed/coverage_depth.txt` | æ–‡æœ¬ | è¦†ç›–åº¦æ•°æ® |
| `data/processed/alignment_ebov_stats.txt` | æ–‡æœ¬ | æ¯”å¯¹ç»Ÿè®¡ |
| `data/results/variant_statistics.json` | æ–‡æœ¬ | å˜å¼‚åŸºç¡€ç»Ÿè®¡åˆ†æ |
| `data/results/evo2_test.json` | æ–‡æœ¬ | Evo 2 æµ‹è¯•ç»“æœ |

---

## 8. å…³é”®å‘ç°ä¸ç”Ÿç‰©å­¦è§£è¯»

### 8.1 é«˜ç—…æ¯’è½½é‡

- **å¹³å‡è¦†ç›–æ·±åº¦**: 3,771.24x
- **è§£è¯»**: æé«˜çš„ç—…æ¯’è½½é‡ï¼Œè¡¨æ˜æ ·æœ¬ä¸­åŸƒåšæ‹‰ç—…æ¯’ RNA ä¸°åº¦å¾ˆé«˜
- è¿™ä¸æ€¥æ€§åŸƒåšæ‹‰ç—…æ¯’æ„ŸæŸ“æœŸçš„ç‰¹å¾ä¸€è‡´

### 8.2 é«˜çªå˜ç‡

- **å˜å¼‚å¯†åº¦**: 29.96 å˜å¼‚/kb
- **è§£è¯»**: ä¸åŸƒåšæ‹‰ç—…æ¯’çš„é«˜çªå˜ç‡ä¸€è‡´
- RNA ç—…æ¯’ç¼ºä¹æ ¡å¯¹æœºåˆ¶ï¼Œå¯¼è‡´é«˜çªå˜ç‡

### 8.3 å˜å¼‚æ¨¡å¼åˆ†æ

**è¿‡æ¸¡åå‘æ€§**:
- **Gâ†’A è¿‡æ¸¡** (76.0%) å ä¸»å¯¼åœ°ä½
- å¯èƒ½ä¸ RNA ç¼–è¾‘é…¶çš„æ´»æ€§ç›¸å…³
- è¿™ç§åå‘æ€§åœ¨ä¸çŠ¶ç—…æ¯’ RNA åºåˆ—ä¸­å¸¸è§

**çƒ­ç‚¹åŒºåŸŸ**:
- å˜å¼‚åœ¨æ•´ä¸ªåŸºå› ç»„ä¸­ç›¸å¯¹å‡åŒ€åˆ†å¸ƒ
- éƒ¨åˆ†åŒºåŸŸå¯èƒ½æœ‰è¾ƒé«˜çš„å˜å¼‚å¯†åº¦
- éœ€è¦è¿›ä¸€æ­¥çš„åŠŸèƒ½æ³¨é‡Šæ¥è¯†åˆ«çƒ­ç‚¹

### 8.4 æ•°æ®è´¨é‡è¯„ä¼°

**æ¯”å¯¹ç‡ä¼˜åŒ–æ•ˆæœ**:
- ä» 39.82%ï¼ˆé»˜è®¤å‚æ•°ï¼‰æå‡åˆ° 49.75%ï¼ˆæ•æ„Ÿæ¨¡å¼ï¼‰
- è¡¨æ˜éƒ¨åˆ†readséœ€è¦æ›´å®½æ¾çš„æ¯”å¯¹æ¡ä»¶
- å¯èƒ½ç”±äºç—…æ¯’å‡†ç§å¤šæ ·æ€§æˆ–æµ‹åºè´¨é‡å˜å¼‚

**æœªæ¯”å¯¹ reads åˆ†æ**:
- 50.25% çš„readsæœªæ¯”å¯¹åˆ°åŸƒåšæ‹‰ç—…æ¯’åŸºå› ç»„
- å¯èƒ½æ¥æºï¼š
  1. **å®¿ä¸»åŸºå› ç»„æ±¡æŸ“**: äººç±» RNA æ˜¯ä¸»è¦å€™é€‰
  2. **æ¥å¤´åºåˆ—**: æµ‹åºæ¥å¤´æœªå®Œå…¨å»é™¤
  3. **ä½è´¨é‡reads**: Read 2 å¹³å‡è´¨é‡è¾ƒä½ï¼ˆ21.29 vs 31.39ï¼‰
  4. **ç—…æ¯’å‡†ç§**: ç—…æ¯’å˜å¼‚å¯¼è‡´æŸäº›readsä¸å‚è€ƒåºåˆ—å·®å¼‚è¾ƒå¤§

---

## 9. æ–¹æ³•è®º

### 9.1 ä¸»è¦æˆå°±

1. âœ… **å®Œæ•´çš„ RNA-seq æ ‡å‡†åˆ†ææµç¨‹**
   - æ•°æ®ä¸‹è½½ â†’ è´¨é‡æ§åˆ¶ â†’ æ¯”å¯¹ â†’ ç»Ÿè®¡ â†’ å˜å¼‚æ£€æµ‹
   - æ‰€æœ‰æ­¥éª¤å‡ä½¿ç”¨æ ‡å‡†å·¥å…·ï¼ˆFastQC, Bowtie2, SAMtools, bcftoolsï¼‰

2. âœ… **é—®é¢˜è¯Šæ–­ä¸ä¿®æ­£**
   - è¯†åˆ«å¹¶ä¿®æ­£äº†å‚è€ƒåŸºå› ç»„ç‰©ç§ä¸åŒ¹é…é—®é¢˜ï¼ˆå¤§è‚ æ†èŒ â†’ åŸƒåšæ‹‰ç—…æ¯’ï¼‰
   - é€šè¿‡ä¼˜åŒ–æ¯”å¯¹å‚æ•°å°†æ¯”å¯¹ç‡ä» 39.82% æå‡åˆ° 49.75%

3. âœ… **å…¨é¢çš„å˜å¼‚æ£€æµ‹ä¸ç»Ÿè®¡**
   - æ£€æµ‹åˆ° 568 ä¸ªé«˜è´¨é‡ SNP
   - å®Œæˆäº†å˜å¼‚ç±»å‹ã€ä½ç½®åˆ†å¸ƒã€å¯†åº¦ç­‰åŸºç¡€ç»Ÿè®¡åˆ†æ

4. âœ… **Evo 2 ç¯å¢ƒå‡†å¤‡**
   - Docker ç¯å¢ƒå·²æˆåŠŸå¯åŠ¨
   - evo2_1b_base æ¨¡å‹å·²ä¸‹è½½å¹¶æµ‹è¯•
   - GPU (CUDA 12.9) å·²å¯ç”¨å¹¶æ­£å¸¸å·¥ä½œ

5. âš ï¸ **Evo 2 å˜å¼‚æ•ˆåº”é¢„æµ‹**
   - æ¨¡å‹ç¯å¢ƒå·²å°±ç»ª
   - VCF æ–‡ä»¶è§£ææˆåŠŸ
   - åŸºç¡€æ¨ç†æµ‹è¯•æˆåŠŸ
   - **æŠ€æœ¯æŒ‘æˆ˜**: EVO 2 çš„è¾“å‡ºæ ¼å¼å¤æ‚ï¼Œæ‰¹å¤„ç†éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•

### 9.2 ç”Ÿä¿¡åˆ†æèƒ½åŠ›éªŒè¯

**å·²éªŒè¯çš„èƒ½åŠ›**:
- âœ… æ•°æ®ç®¡ç†å’Œä¸‹è½½ï¼ˆENA, NCBIï¼‰
- âœ… å‚è€ƒåŸºå› ç»„å‡†å¤‡å’Œæ¯”å¯¹
- âœ… NGS æ•°æ®å¤„ç†ï¼ˆè´¨æ§ã€æ¯”å¯¹ã€å˜å¼‚æ£€æµ‹ï¼‰
- âœ… ç»Ÿè®¡åˆ†æå’Œå¯è§†åŒ–ï¼ˆè¦†ç›–åº¦ã€å˜å¼‚åˆ†å¸ƒï¼‰
- âœ… Docker å®¹å™¨åŒ–ç¯å¢ƒç®¡ç†
- âš ï¸ Evo 2 æ·±åº¦å­¦ä¹ åº”ç”¨ï¼ˆç¯å¢ƒå·²å°±ç»ªï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒè¯•ï¼‰

### 9.3 æŠ€æœ¯äº®ç‚¹

**Docker å®¹å™¨åŒ–ä¼˜åŠ¿**:
- ç¯å¢ƒä¸€è‡´æ€§ï¼šæ‰€æœ‰åˆ†æåœ¨éš”ç¦»å®¹å™¨ä¸­è¿è¡Œ
- èµ„æºéš”ç¦»ï¼šé¿å…æœ¬åœ°ç¯å¢ƒæ±¡æŸ“
- å¯é‡ç°æ€§ï¼šæ ‡å‡†åŒ–çš„å·¥ä½œæµç¨‹å’Œé…ç½®

**æ•°æ®å¤„ç†ä¼˜åŒ–**:
- æ‰¹å¤„ç†ç­–ç•¥ï¼šå¤§è§„æ¨¡æ•°æ®å¤„ç†ï¼ˆ568ä¸ªå˜å¼‚ï¼‰
- å†…å­˜ç®¡ç†ï¼šä½¿ç”¨ 67GB swap ç¼“è§£å†…å­˜å‹åŠ›
- GPU åŠ é€Ÿï¼šåˆ©ç”¨ CUDA 12.9 è¿›è¡Œé«˜æ•ˆè®¡ç®—

**é¡¹ç›®ç»“æ„è§„èŒƒ**:
- éµå¾ªäº†é¢„å®šä¹‰çš„æ•°æ®å­˜å‚¨è§„èŒƒ
- å‚è€ƒåŸºå› ç»„ï¼š`shared_data/references/`
- é¡¹ç›®æ•°æ®ï¼š`projects/<é¡¹ç›®å>/data/{raw|processed|results}/`

---

## 10. å»ºè®®ä¸åç»­æ­¥éª¤

### 10.1 Evo 2 å˜å¼‚æ•ˆåº”é¢„æµ‹ - è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: ç»§ç»­è°ƒè¯•æ‰¹å¤„ç†è„šæœ¬
**ä¼˜ç‚¹**:
- å¯ä»¥å®Œæˆå®Œæ•´çš„ 568 ä¸ªå˜å¼‚åˆ†æ
- æä¾›é›¶æ ·æœ¬å˜å¼‚æ•ˆåº”é¢„æµ‹

**æŒ‘æˆ˜**:
- éœ€è¦è§£å†³ EVO 2 è¾“å‡ºæ ¼å¼è§£æé—®é¢˜
- æ‰¹å¤„ç†é€»è¾‘éœ€è¦ä¼˜åŒ–

#### æ–¹æ¡ˆ B: ä½¿ç”¨é¢„è®¡ç®—çš„åµŒå…¥
**ä¼˜ç‚¹**:
- å¦‚æœ EVO 2 æ”¯æŒæå–åµŒå…¥ï¼Œå¯ä»¥ä¸€æ¬¡æ€§è·å–æ‰€æœ‰åºåˆ—çš„åµŒå…¥
- é¿å…å¤æ‚çš„æ¨¡å‹æ¨ç†å¾ªç¯
- è®¡ç®—æ•ˆç‡æ›´é«˜

**æŒ‘æˆ˜**:
- éœ€è¦ç¡®è®¤ EVO 2 æ˜¯å¦æä¾›åµŒå…¥æå–æ¥å£

#### æ–¹æ¡ˆ C: åŸºäºç»Ÿè®¡åˆ†æè¿›è¡Œå˜å¼‚ä¼˜å…ˆçº§æ’åº

**ä¼˜ç‚¹**:
- å·²æœ‰å®Œæ•´çš„å˜å¼‚ç»Ÿè®¡
- å¯ä»¥åŸºäºä¼ ç»ŸæŒ‡æ ‡ï¼ˆè´¨é‡ã€æ·±åº¦ã€ä½ç½®ï¼‰è¿›è¡Œæ’åº
- ä¸ä¾èµ– EVO 2 å¤æ‚çš„è¾“å‡ºæ ¼å¼

**æŒ‘æˆ˜**:
- ç¼ºå°‘ Evo 2 çš„æ·±åº¦å­¦ä¹ é¢„æµ‹
- æ— æ³•æ•æ‰åºåˆ—çš„è¯­ä¹‰ç‰¹å¾

**æ¨èæ–¹æ¡ˆ**: æ–¹æ¡ˆ B â†’ æ–¹æ¡ˆ A â†’ æ–¹æ¡ˆ C
ä¼˜å…ˆä½¿ç”¨åµŒå…¥æå–ï¼Œå¦‚æœä¸å¯ç”¨åˆ™ç»§ç»­è°ƒè¯•æ‰¹å¤„ç†

### 10.2 è¿›ä¸€æ­¥ç”Ÿä¿¡åˆ†æå»ºè®®

#### å»ºè®® 1: å®¿ä¸»åŸºå› ç»„å»é™¤
**ç›®çš„**: æé«˜ç—…æ¯’reads æ¯”å¯¹ç‡
**æ–¹æ³•**:
```bash
# å…ˆæ¯”å¯¹åˆ°äººç±»åŸºå› ç»„ï¼Œå»é™¤å®¿ä¸»reads
bowtie2 -x hg38_index -1 R1.fastq -2 R2.fastq \
        --un-conc-gz clean_R%.fastq.gz

# ç”¨æ¸…ç†åçš„readsæ¯”å¯¹ç—…æ¯’åŸºå› ç»„
bowtie2 -x ebov_zaire_index -1 clean_R1.fastq.gz -2 clean_R2.fastq.gz \
        --very-sensitive-local
```
**é¢„æœŸæ•ˆæœ**: æ¯”å¯¹ç‡å¯èƒ½ä» 49.75% æå‡åˆ° 60-70%

#### å»ºè®® 2: å˜å¼‚åŠŸèƒ½æ³¨é‡Š
**ç›®çš„**: è¯†åˆ«å˜å¼‚å¯¹ç—…æ¯’åŠŸèƒ½çš„å½±å“
**å·¥å…·**: SnpEff, VEP (Variant Effect Predictor)
**è¾“å…¥**: SRR1972739_variants.vcf
**è¾“å‡º**: å˜å¼‚å¯¹åŸºå› çš„å½±å“é¢„æµ‹ï¼ˆåŒä¹‰ã€é”™ä¹‰ã€æ— ä¹‰ï¼‰

#### å»ºè®® 3: å˜å¼‚å¯è§†åŒ–
**ç›®çš„**: å¯è§†åŒ–å˜å¼‚åˆ†å¸ƒå’Œè¦†ç›–åº¦
**å·¥å…·**: R åŒ…ï¼ˆggplot2, ggbioï¼‰ï¼ŒPythonï¼ˆmatplotlib, seabornï¼‰
**åˆ†æ**:
- å˜å¼‚å¯†åº¦å›¾ï¼ˆæ›¼å“ˆé¡¿å›¾ï¼‰
- è¦†ç›–åº¦å›¾ï¼ˆåŸºå› ç»„æµè§ˆå™¨é£æ ¼ï¼‰
- çƒ­ç‚¹åŒºåŸŸè¯†åˆ«

#### å»ºè®® 4: æ¯’æ ªé‰´å®š
**ç›®çš„**: ç¡®å®šæ ·æœ¬çš„å…·ä½“åŸƒåšæ‹‰ç—…æ¯’æ¯’æ ª
**æ–¹æ³•**:
1. å°†å˜å¼‚åºåˆ—ä¸å…¶ä»–å·²çŸ¥æ¯’æ ªè¿›è¡Œç³»ç»Ÿå‘è‚²åˆ†æ
2. ä½¿ç”¨ MAFFT è¿›è¡Œå¤šåºåˆ—æ¯”å¯¹
3. ä½¿ç”¨ IQ-TREE æ„å»ºç³»ç»Ÿå‘è‚²æ ‘
4. è¯†åˆ«æœ€æ¥è¿‘çš„å·²çŸ¥æ¯’æ ª

#### å»ºè®® 5: è¡¨è¾¾å®šé‡
**ç›®çš„**: å®šé‡ç—…æ¯’è½½é‡
**å·¥å…·**: featureCounts, HTSeq
**è¾“å…¥**: æ¯”å¯¹çš„ BAM æ–‡ä»¶
**è¾“å‡º**: åŸºå› æ°´å¹³çš„è¡¨è¾¾é‡ï¼ˆRPKM/FPKMï¼‰
**åº”ç”¨**: è¯†åˆ«é«˜è¡¨è¾¾ç—…æ¯’åŸºå› 

#### å»ºè®® 6: é‡ç»„ç—…æ¯’åˆ†æ
**ç›®çš„**: æ£€æµ‹æ½œåœ¨çš„é‡ç»„ç—…æ¯’
**å·¥å…·**: R 4 (Recombination Detection Program)
**è¾“å…¥**: æ¯”å¯¹çš„ reads æˆ–è£…é…åºåˆ—
**è¾“å‡º**: é‡ç»„æ–­ç‚¹å›¾è°±
**åº”ç”¨**: è¯†åˆ«ç—…æ¯’åŸºå› ç»„ä¸­çš„é‡ç»„äº‹ä»¶

---

## 11. å‚è€ƒä¿¡æ¯

### 11.1 ä½¿ç”¨çš„å·¥å…·ç‰ˆæœ¬

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Bowtie2 | 2.x | åºåˆ—æ¯”å¯¹ |
| SAMtools | 1.21+htslib-1.21 | BAM/VCF å¤„ç† |
| bcftools | 1.21+htslib-1.21 | å˜å¼‚æ£€æµ‹ |
| FastQC | - | è´¨é‡æ§åˆ¶ |
| Evo 2 | evo2_1b_base | æ·±åº¦å­¦ä¹ åˆ†æ |
| PyTorch | 2.7.0a0 | æ·±åº¦å­¦ä¹ æ¡†æ¶ |
| Biopython | - | åºåˆ—å¤„ç† |

### 11.2 å‚è€ƒæ•°æ®

| æ•°æ® | æ¥æº | Accession |
|------|------|----------|
| å‚è€ƒåŸºå› ç»„ | NCBI | NC_002549.1 |
| æµ‹åºæ•°æ® | ENA | SRR1972739 |
| æ ·æœ¬ä¿¡æ¯ | - | G4252.1 (Zaire ebolavirus) |

### 11.3 ä½¿ç”¨çš„æ ‡å‡†åè®®

| åè®® | ç”¨é€” |
|------|------|
| FASTA | å‚è€ƒåŸºå› ç»„æ ¼å¼ |
| FASTQ | æµ‹åºæ•°æ®æ ¼å¼ |
| VCF v4.2 | å˜å¼‚æ£€æµ‹æ ¼å¼ |
| SAM/BAM | æ¯”å¯¹ç»“æœæ ¼å¼ |

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-22 17:50
**å·¥ä½œåŒº**: /media/vimalinx/Data/bio_studio
**é¡¹ç›®è·¯å¾„**: projects/test_rnaseq_analysis/
**åˆ†æå·¥å…·**: Bioinformatics Toolkit + Evo 2 Deep Learning

---

## é™„å½• A: æ‰§è¡Œå‘½ä»¤è®°å½•

### A.1 æ•°æ®ä¸‹è½½
```bash
# åŸƒåšæ‹‰ç—…æ¯’å‚è€ƒåŸºå› ç»„
curl -L "https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/005/845/GCF_000005845.2_ASM584v2/GCF_000005845.2_ASM584v2_genomic.fna.gz" \
    -o ecoli_K12.fna.gz
gunzip -c ecoli_K12.fna.gz > ecoli_K12.fa

# ä½¿ç”¨ Biopython ä¸‹è½½ EBOV å‚è€ƒåŸºå› ç»„
from Bio import Entrez
Entrez.email = "user@example.com"
handle = Entrez.efetch(db="nucleotide", id="10313991", rettype="fasta", retmode="text")
fasta_data = handle.read()
handle.close()
with open("ebov_zaire.fa", "w") as f:
    f.write(fasta_data)

# æµ‹åºæ•°æ®
curl -L -o SRR1972739_1.fastq.gz \
    "https://ftp.sra.ebi.ac.uk/vol1/fastq/SRR197/009/SRR1972739/SRR1972739_1.fastq.gz"
curl -L -o SRR1972739_2.fastq.gz \
    "https://ftp.sra.ebi.ac.uk/vol1/fastq/SRR197/009/SRR1972739/SRR1972739/SRR1972739_2.fastq.gz"
```

### A.2 è´¨é‡æ§åˆ¶
```bash
cd projects/test_rnaseq_analysis/data/processed
mkdir -p qc
fastqc -t 4 -o qc ../raw/SRR1972739_1.fastq.gz ../raw/SRR1972739_2.fastq.gz
```

### A.3 åºåˆ—æ¯”å¯¹
```bash
# é”™è¯¯æ¯”å¯¹ï¼ˆå¤§è‚ æ†èŒï¼‰
bowtie2 -x /media/vimalinx/Data/bio_studio/shared_data/references/ecoli_K12_index \
        -1 ../raw/SRR1972739_1.fastq.gz -2 ../raw/SRR1972739_2.fastq.gz \
        -S SRR1972739_aligned.sam -p 4

# æ­£ç¡®æ¯”å¯¹ï¼ˆåŸƒåšæ‹‰ç—…æ¯’ - é»˜è®¤å‚æ•°ï¼‰
cd shared_data/references
bowtie2-build ebov_zaire.fa ebov_zaire_index
cd projects/test_rnaseq_analysis/data/processed
bowtie2 -x /media/vimalinx/Data/bio_studio/shared_data/references/ebov_zaire_index \
        -1 ../raw/SRR1972739_1.fastq.gz -2 ../raw/SRR1972739_2.fastq.gz \
        -S SRR1972739_ebov_aligned.sam -p 4

# ä¼˜åŒ–æ¯”å¯¹ï¼ˆæ•æ„Ÿæ¨¡å¼ï¼‰
bowtie2 -x /media/vimalinx/Data/bio_studio/shared_data/references/ebov_zaire_index \
        -1 ../raw/SRR1972739_1.fastq.gz -2 ../raw/SRR1972739_2.fastq.gz \
        -S SRR1972739_ebov_sensitive.sam -p 4 --very-sensitive-local
```

### A.4 BAM è½¬æ¢å’Œç»Ÿè®¡
```bash
cd projects/test_rnaseq_analysis/data/processed
samtools view -bS SRR1972739_ebov_sensitive.sam -o SRR1972739_ebov_sensitive.bam
samtools sort SRR1972739_ebov_sensitive.bam -o SRR1972739_ebov_sensitive.sorted.bam
samtools index SRR1972739_ebov_sensitive.sorted.bam
samtools flagstat SRR1972739_ebov_sensitive.sorted.bam > alignment_ebov_stats.txt
```

### A.5 è¦†ç›–åº¦åˆ†æ
```bash
samtools depth SRR1972739_ebov_sensitive.sorted.bam > coverage_depth.txt
```

### A.6 å˜å¼‚æ£€æµ‹
```bash
bcftools mpileup -f /media/vimalinx/Data/bio_studio/shared_data/references/ebov_zaire.fa \
                SRR1972739_ebov_sensitive.sorted.bam \
    | bcftools call -mv -O v -o SRR1972739_variants.vcf
```

### A.7 å˜å¼‚åŸºç¡€ç»Ÿè®¡
```python
# Python è„šæœ¬ç»Ÿè®¡ 568 ä¸ª SNP çš„åˆ†å¸ƒã€é¢‘ç‡å’Œå¯†åº¦
import json
from collections import Counter
import numpy as np

# è¯»å– VCF
variants = []
with open("projects/test_rnaseq_analysis/data/processed/SRR1972739_variants.vcf", "r") as f:
    for line in f:
        if line.startswith("#"):
            continue
        fields = line.strip().split("\t")
        if len(fields) >= 5:
            ref, alt = fields[3], fields[4]
            if len(ref) == 1 and len(alt) == 1 and ref != "." and alt != ".":
                variants.append({"ref": ref, "alt": alt})

# ç»Ÿè®¡
ref_nuc_counts = Counter()
alt_nuc_counts = Counter()
transitions = []

for v in variants:
    ref_nuc_counts[v["ref"]] += 1
    alt_nuc_counts[v["alt"]] += 1
    if v["ref"] == "A" and v["alt"] in ["G", "C", "T"]:
        transitions.append(f"A->{v['alt']}")

# ä¿å­˜ç»Ÿè®¡
output = {
    "total_variants": len(variants),
    "ref_nucleotide_distribution": dict(ref_nuc_counts),
    "alt_nucleotide_distribution": dict(alt_nuc_counts),
    "transitions": dict(Counter(transitions)),
    "position_stats": {
        "min": min(v['pos'] for v in variants),
        "max": max(v['pos'] for v in variants),
        "mean": float(np.mean([v['pos'] for v in variants])),
    },
    "variant_density": len(variants) / 18959 * 1000,
}

with open("projects/test_rnaseq_analysis/data/results/variant_statistics.json", "w") as f:
    json.dump(output, f, indent=2)
```

### A.8 Evo 2 ç¯å¢ƒå‡†å¤‡
```bash
# Docker å®¹å™¨å¯åŠ¨
cd /media/vimalinx/Data/bio_studio
docker compose -f evo2/docker-compose.override.yml run --rm -d --name evo2-analysis evo2 sleep infinity

# éªŒè¯ç¯å¢ƒ
docker exec evo2-analysis python3 -c "
from evo2 import Evo2
import torch
evo2_model = Evo2('evo2_1b_base')
device = 'cuda:0' if torch.cuda.is_available() else 'cpu'
print(f'Device: {device}')
print(f'GPU available: {torch.cuda.is_available()}')
print(f'CUDA version: {torch.version.cuda if torch.cuda.is_available() else \"N/A\"}')
test_seq = 'ATGCGTACGT'
tokens = evo2_model.tokenizer.tokenize(test_seq)
print(f'Token count: {len(tokens)}')
test_input = torch.tensor([tokens], dtype=torch.long).to(device)
with torch.no_grad():
    output = evo2_model(test_input)
    print(f'Output shape: {output[0].shape}')
print('âœ“ Evo 2 basic test completed')
"
```

---

**æŠ¥å‘Šç»“æŸ**
